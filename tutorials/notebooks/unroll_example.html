<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Unrolling Tutorial" />
<meta property="og:type" content="website" />
<meta property="og:url" content="tutorials/notebooks/unroll_example.html" />
<meta property="og:site_name" content="SMURF" />
<meta property="og:description" content="We use mouse brain and mouse small intestine data, which are single-cell adata objects obtained directly from segmentation analysis. Dataset Information: Access the dataset here: Visium HD CytAssis..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="_images/social_previews/summary_tutorials_notebooks_unroll_example_266bac39.png" />
<meta property="og:image:alt" content="We use mouse brain and mouse small intestine data, which are single-cell adata objects obtained directly from segmentation analysis. Dataset Information: Access the dataset here: Visium HD CytAssis..." />
<meta name="description" content="We use mouse brain and mouse small intestine data, which are single-cell adata objects obtained directly from segmentation analysis. Dataset Information: Access the dataset here: Visium HD CytAssis..." />
<meta name="twitter:card" content="summary_large_image" />
<link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html"><link rel="next" title="Nuclei Segmentation by StarDist" href="Tutorial_cell_segmentation.html"><link rel="prev" title="Soft Segmentation Tutorial (Full version)" href="Tutorial_Mousebrian_full.html">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.09.25 -->
        <title>Unrolling Tutorial - SMURF</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #003262;
  --color-brand-content: #003262;
  --admonition-font-size: var(--font-size-normal);
  --admonition-title-font-size: var(--font-size-normal);
  --code-font-size: var(--font-size--small);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">SMURF</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <span class="sidebar-brand-text">SMURF</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Tutorials</a><input aria-label="Toggle navigation of Tutorials" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Tutorial_Mousebrian.html">Soft Segmentation Tutorial (Lite version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial_Mousebrian_full.html">Soft Segmentation Tutorial (Full version)</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Unrolling Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Unrolling-Mouse-Brain-Data">Unrolling Mouse Brain Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Unrolling-Mouse-Small-Intestine-Data">Unrolling Mouse Small Intestine Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial_cell_segmentation.html">Nuclei Segmentation by StarDist</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Data_structure/index.html">Data Structure</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">API</a><input aria-label="Toggle navigation of API" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/smurf.html">SMURF</a><input aria-label="Toggle navigation of SMURF" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.calculate_weight_to_celltype.html">smurf.calculate_weight_to_celltype</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.expanding_cells.html">smurf.expanding_cells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.get_finaldata.html">smurf.get_finaldata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.get_finaldata_fast.html">smurf.get_finaldata_fast</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.itering_arragement.html">smurf.itering_arragement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.make_pixels_cells.html">smurf.make_pixels_cells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.make_preparation.html">smurf.make_preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.nuclei_rna.html">smurf.nuclei_rna</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.plot_cellcluster_position.html">smurf.plot_cellcluster_position</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.plot_results.html">smurf.plot_results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.prepare_dataframe_image.html">smurf.prepare_dataframe_image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.return_celltype_plot.html">smurf.return_celltype_plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.singlecellanalysis.html">smurf.singlecellanalysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.start_optimization.html">smurf.start_optimization</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/spatial_object.html">Spatial Object</a><input aria-label="Toggle navigation of Spatial Object" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.spatial_object.spatial_object.html">smurf.spatial_object.spatial_object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.spatial_object.spatial_object.add_segmentation.html">smurf.spatial_object.spatial_object.add_segmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.spatial_object.spatial_object.generate_cell_spots_information.html">smurf.spatial_object.spatial_object.generate_cell_spots_information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/smurf.spatial_object.spatial_object.image_temp.html">smurf.spatial_object.spatial_object.image_temp</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/The-Mitra-Lab/SMURF">GitHub</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/tutorials/notebooks/unroll_example.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="Unrolling-Tutorial">
<h1>Unrolling Tutorial<a class="headerlink" href="#Unrolling-Tutorial" title="Link to this heading">¶</a></h1>
<p>We use mouse brain and mouse small intestine data, which are single-cell adata objects obtained directly from segmentation analysis.</p>
<section id="Dataset-Information">
<h2>Dataset Information<a class="headerlink" href="#Dataset-Information" title="Link to this heading">¶</a></h2>
<p>Access the dataset here: <a class="reference external" href="https://www.10xgenomics.com/datasets/visium-hd-cytassist-gene-expression-libraries-of-mouse-brain-he">Visium HD CytAssist Gene Expression Libraries of Mouse Brain(FFPE)</a> and <a class="reference external" href="https://www.10xgenomics.com/datasets/visium-hd-cytassist-gene-expression-libraries-of-mouse-intestine">Visium HD Spatial Gene Expression Library, Mouse Small Intestine (FFPE)</a></p>
<p>The unrolling process mainly consists of two parts: 1) finding the x-axis and then obtaining the y-axis. In the first part, we use the previous cluster results to determine and find the cluster representing the x-axis. In the second part, we proceed to unwrap the y-axis using two different methods. The first method is to use the straight-line distance of each cell from the x-axis (as in the mouse brain example). 2) The second method is to use a relative distance, where each cell must be
connected to another cell, resulting in a one-by-one distance to the x-axis (as in the mouse small intestine data). The choice of method depends on the specific dataset—generally, naturally formed loops use the first method, while artificially formed loops from experiments use the second method.</p>
<p>Particularly, the first part mainly contains 3 steps:</p>
<ol class="arabic simple">
<li><p>Delete cells that are clearly not on the x-axis.</p></li>
<li><p>Cells on the x-axis, but in the beginning or end segments, which may be fragmented due to experimental reasons, need to be kept separately.</p></li>
<li><p>Unroll x-axis by locally linear embedding.</p></li>
</ol>
<p>Main functions for unwrolling contains:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.select_cells()">su.select_cells()</a>: to select the cells from the boundary cluster for the x-axis. [su.select_cells()]</p></li>
<li><p><a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.clean_select()">su.clean_select()</a>: to clean the selected.</p></li>
<li><p><a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.x_axis()-and-su.x_axis_pre()">su.x_axis()</a> and <a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.x_axis()-and-su.x_axis_pre()">su.x_axis_pre()</a>: to build the x-axis.</p></li>
<li><p><a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.select_rest_cells()">su.select_rest_cells()</a>: to find all remaining cells for the y-axis.</p></li>
<li><p><a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.y_axis()">su.y_axis()</a> and <a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.y_axis_circle()">su.y_axis_circle()</a> to get the final y-axis results.</p></li>
</ol>
<p>In the meantime, we can use <code class="docutils literal notranslate"><span class="pre">su.plot_selected()</span></code> to view our data and <code class="docutils literal notranslate"><span class="pre">su.plot_final_result()</span></code> to take a look at the final results.</p>
<p>For how to use SMURF to achieve your desired results, please refer to the examples. Thank you.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">smurf</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">su</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
<blockquote>
<div><p><strong>Note on software versions</strong></p>
<div class="line-block">
<div class="line">This tutorial was developed and tested with the exact package versions listed below.</div>
<div class="line">Using these versions should reproduce the results exactly.</div>
<div class="line">Newer releases may introduce subtle differences.</div>
<div class="line">If you encounter any issues, please open an issue on our <a class="reference external" href="https://github.com/The-Mitra-Lab/SMURF/issues">GitHub repository</a> and we’ll respond as soon as possible. Thanks!</div>
</div>
</div></blockquote>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>numpy</p></td>
<td><p>1.26.4</p></td>
</tr>
<tr class="row-odd"><td><p>pandas</p></td>
<td><p>1.5.3</p></td>
</tr>
<tr class="row-even"><td><p>tqdm</p></td>
<td><p>4.66.2</p></td>
</tr>
<tr class="row-odd"><td><p>scanpy</p></td>
<td><p>1.10.0</p></td>
</tr>
<tr class="row-even"><td><p>scipy</p></td>
<td><p>1.12.0</p></td>
</tr>
<tr class="row-odd"><td><p>matplotlib</p></td>
<td><p>3.8.3</p></td>
</tr>
<tr class="row-even"><td><p>numba</p></td>
<td><p>0.59.0</p></td>
</tr>
<tr class="row-odd"><td><p>scikit-learn</p></td>
<td><p>1.4.1.post1</p></td>
</tr>
<tr class="row-even"><td><p>Pillow</p></td>
<td><p>10.2.0</p></td>
</tr>
<tr class="row-odd"><td><p>anndata</p></td>
<td><p>0.10.6</p></td>
</tr>
<tr class="row-even"><td><p>h5py</p></td>
<td><p>3.10.0</p></td>
</tr>
<tr class="row-odd"><td><p>pyarrow</p></td>
<td><p>16.1.0</p></td>
</tr>
<tr class="row-even"><td><p>igraph</p></td>
<td><p>0.11.5</p></td>
</tr>
</tbody>
</table>
</div>
<p>Here are the python codes you can use to install the exact versions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">importlib.metadata</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">metadata</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="c1"># Dictionary of desired package versions</span>
<span class="n">desired_versions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;numpy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.26.4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pandas&quot;</span><span class="p">:</span> <span class="s2">&quot;1.5.3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tqdm&quot;</span><span class="p">:</span> <span class="s2">&quot;4.66.2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;scanpy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.10.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;scipy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.12.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;matplotlib&quot;</span><span class="p">:</span> <span class="s2">&quot;3.8.3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;numba&quot;</span><span class="p">:</span> <span class="s2">&quot;0.59.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;scikit-learn&quot;</span><span class="p">:</span> <span class="s2">&quot;1.4.1.post1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Pillow&quot;</span><span class="p">:</span> <span class="s2">&quot;10.2.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;anndata&quot;</span><span class="p">:</span> <span class="s2">&quot;0.10.6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;h5py&quot;</span><span class="p">:</span> <span class="s2">&quot;3.10.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pyarrow&quot;</span><span class="p">:</span> <span class="s2">&quot;16.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;igraph&quot;</span><span class="p">:</span> <span class="s2">&quot;0.11.5&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">pkg</span><span class="p">,</span> <span class="n">target_ver</span> <span class="ow">in</span> <span class="n">desired_versions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">installed_ver</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">version</span><span class="p">(</span><span class="n">pkg</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">metadata</span><span class="o">.</span><span class="n">PackageNotFoundError</span><span class="p">:</span>
        <span class="n">installed_ver</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">installed_ver</span> <span class="o">!=</span> <span class="n">target_ver</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pkg</span><span class="si">}</span><span class="s2"> current version: </span><span class="si">{</span><span class="n">installed_ver</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;not installed&#39;</span><span class="si">}</span><span class="s2">, installing/upgrading to </span><span class="si">{</span><span class="n">target_ver</span><span class="si">}</span><span class="s2">…&quot;</span><span class="p">)</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;pip&quot;</span><span class="p">,</span> <span class="s2">&quot;install&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pkg</span><span class="si">}</span><span class="s2">==</span><span class="si">{</span><span class="n">target_ver</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span>
            <span class="n">check</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pkg</span><span class="si">}</span><span class="s2"> is already at version </span><span class="si">{</span><span class="n">target_ver</span><span class="si">}</span><span class="s2">, no action needed.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="Unrolling-Mouse-Brain-Data">
<h1>Unrolling Mouse Brain Data<a class="headerlink" href="#Unrolling-Mouse-Brain-Data" title="Link to this heading">¶</a></h1>
<p>Let’s first start with the mouse brain example.</p>
<p>To download the final result directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">The</span><span class="o">-</span><span class="n">Mitra</span><span class="o">-</span><span class="n">Lab</span><span class="o">/</span><span class="n">SMURF</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">datasets</span><span class="o">/</span><span class="n">adata_sc_final_mousebrain</span><span class="o">.</span><span class="n">h5ad</span><span class="o">.</span><span class="n">gz</span>
<span class="err">!</span> <span class="n">gunzip</span> <span class="n">adata_sc_final_mousebrain</span><span class="o">.</span><span class="n">h5ad</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#! wget https://github.com/The-Mitra-Lab/SMURF/releases/download/datasets/adata_sc_final_mousebrain.h5ad.gz</span>
<span class="c1">#! gunzip adata_sc_final_mousebrain.h5ad.gz</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adata_sc_final_mousebrain</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="s1">&#39;adata_sc_final_mousebrain.h5ad&#39;</span><span class="p">)</span>
<span class="n">adata_sc_final_mousebrain</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AnnData object with n_obs × n_vars = 56859 × 19059
    obs: &#39;cell_cluster&#39;, &#39;cos_simularity&#39;, &#39;cell_size&#39;, &#39;array_row&#39;, &#39;array_col&#39;, &#39;n_counts&#39;
    var: &#39;gene_ids&#39;, &#39;feature_types&#39;
    uns: &#39;spatial&#39;
    obsm: &#39;spatial&#39;
</pre></div></div>
</div>
<section id="su.select_cells()">
<h2>su.select_cells()<a class="headerlink" href="#su.select_cells()" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">su.select_cells(adata,</span> <span class="pre">cluster,</span> <span class="pre">cluster_name='cell_cluster',</span> <span class="pre">spatial_name=['array_row',</span> <span class="pre">'array_col']</span> <span class="pre">,</span> <span class="pre">so=None)</span></code></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">adata</span></code>: Input your adata object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cluster</span></code>: Provide a list of clusters to be included.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cluster_name</span></code>: Specify the name of the cluster in adata.obs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spatial_name</span></code>: A list of two strings specifying the names of the columns in <code class="docutils literal notranslate"><span class="pre">adata.obs</span></code> that contain the spatial coordinates. Defaults to <code class="docutils literal notranslate"><span class="pre">['array_row',</span> <span class="pre">'array_col']</span></code> from SMURF soft segmentation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">so</span></code>: If <code class="docutils literal notranslate"><span class="pre">spatial_name</span></code> are not in adata.obs, please input your <code class="docutils literal notranslate"><span class="pre">so</span></code> (spatial object) from the previous analysis.</p></li>
</ol>
<p>The output of the selected data is a list containing two numpy arrays. The first array includes all the cell IDs selected, and the second array contains the coordinates of the corresponding cells.</p>
<p>In this example, we want to use cluster 13 to build the x-axis.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">select_cells</span><span class="p">(</span><span class="n">adata_sc_final_mousebrain</span><span class="p">,</span> <span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">cluster_name</span> <span class="o">=</span> <span class="s1">&#39;cell_cluster&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Take a look at your data here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">su</span><span class="o">.</span><span class="n">plot_selected</span><span class="p">(</span><span class="n">selected_mousebrain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_9_0.png" src="../../_images/tutorials_notebooks_unroll_example_9_0.png" />
</div>
</div>
</section>
<section id="su.clean_select()">
<h2>su.clean_select()<a class="headerlink" href="#su.clean_select()" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">su.clean_select(selected,</span> <span class="pre">left=None,</span> <span class="pre">right=None,</span> <span class="pre">up=None,</span> <span class="pre">down=None,</span> <span class="pre">outlier_cutoff=20,</span> <span class="pre">outlier_neighbors=6,</span> <span class="pre">delete_xaxis=[np.array([]),</span> <span class="pre">np.zeros((0,</span> <span class="pre">2))],</span> <span class="pre">return_deleted=False,</span> <span class="pre">save_area=[None,</span> <span class="pre">None,</span> <span class="pre">None,</span> <span class="pre">None],</span> <span class="pre">k_neighbors=40,</span> <span class="pre">avg_iterations=1)</span></code></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">selected</span></code>: Please input your selected data.</p></li>
<li><p><strong>Delete cells directly</strong> <code class="docutils literal notranslate"><span class="pre">left</span></code>, <code class="docutils literal notranslate"><span class="pre">right</span></code>, <code class="docutils literal notranslate"><span class="pre">up</span></code>, <code class="docutils literal notranslate"><span class="pre">down</span></code>: We will delete all cells in these areas.</p></li>
<li><p><strong>Delete outliers</strong> <code class="docutils literal notranslate"><span class="pre">outlier_cutoff</span></code>, <code class="docutils literal notranslate"><span class="pre">outlier_neighbors</span></code>, <code class="docutils literal notranslate"><span class="pre">k_neighbors</span></code>, <code class="docutils literal notranslate"><span class="pre">avg_iterations</span></code>: We will delete outliers that meet these criteria. Here, we first add points by averaging iterations (<code class="docutils literal notranslate"><span class="pre">avg_iterations</span></code>) with k neighbors (<code class="docutils literal notranslate"><span class="pre">k_neighbors</span></code>) to get denser cells. Then, we use k-nearest neighbors (k = <code class="docutils literal notranslate"><span class="pre">outlier_neighbors</span></code>) to find the distance between each cell and its neighbors, deleting the cell if the distance is larger than <code class="docutils literal notranslate"><span class="pre">outlier_cutoff</span></code>.</p></li>
<li><p><strong>Secure area</strong> <code class="docutils literal notranslate"><span class="pre">save_area</span></code>: We will save all the cells in this area; these four values represent [<code class="docutils literal notranslate"><span class="pre">left</span></code>, <code class="docutils literal notranslate"><span class="pre">right</span></code>, <code class="docutils literal notranslate"><span class="pre">up</span></code>, <code class="docutils literal notranslate"><span class="pre">down</span></code>].</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete_xaxis</span></code>, <code class="docutils literal notranslate"><span class="pre">return_deleted</span></code>=<code class="docutils literal notranslate"><span class="pre">False</span></code>: In some cases, there are data points on the x-axis, but they are disconnected due to certain reasons, making it impossible to determine the x-axis. We need to delete these points during analysis, but we need to save them as they originally belonged to the x-axis (please see the mouse intestine example for more details, but for now, you may ignore this part).</p></li>
</ol>
<p>The output of this function includes the new selected data and to_delete (only if <code class="docutils literal notranslate"><span class="pre">return_deleted</span></code>=<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
<p><strong>Since assigning a value to the output will modify ``selected``, please confirm the parameters before making any actual changes.</strong></p>
<p>For these analysis please do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_mousebrain</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                <span class="n">down</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">3160</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                <span class="n">save_area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>first. And find the best parameters. Then do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_mousebrain</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                      <span class="n">down</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">3160</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                                      <span class="n">save_area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span><span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>to delete the cells.</p>
<p>You can always perform this multiple times to prepare the best data for x-axis analysis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_mousebrain</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                      <span class="n">down</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">3160</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                                      <span class="n">save_area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span><span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_12_0.png" src="../../_images/tutorials_notebooks_unroll_example_12_0.png" />
</div>
</div>
</section>
<section id="su.x_axis()-and-su.x_axis_pre()">
<h2>su.x_axis() and su.x_axis_pre()<a class="headerlink" href="#su.x_axis()-and-su.x_axis_pre()" title="Link to this heading">¶</a></h2>
<p>We Use <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.LocallyLinearEmbedding.html">LocallyLinearEmbedding</a> for unwrapping x axis.</p>
<p><code class="docutils literal notranslate"><span class="pre">su.x_axis(selected,</span> <span class="pre">adata,</span> <span class="pre">so=None,</span> <span class="pre">seed=42,</span> <span class="pre">n_neighbors=50,</span> <span class="pre">num_avg=35,</span> <span class="pre">unit=5,</span> <span class="pre">resolution=2,</span> <span class="pre">spatial_name=['array_row',</span> <span class="pre">'array_col'])</span></code></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">selected</span></code>: The selected cells from previous analysis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">adata</span></code> and <code class="docutils literal notranslate"><span class="pre">so</span></code>: The adata object. Same as in su.select_cells(). If <code class="docutils literal notranslate"><span class="pre">'x'</span></code> and <code class="docutils literal notranslate"><span class="pre">'y'</span></code> are not in adata.obs, please input your <code class="docutils literal notranslate"><span class="pre">so</span></code> (spatial object) from the previous analysis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">seed</span></code>: A random seed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code>: The number of neighbors for LocallyLinearEmbedding.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_avg=35</span></code>, <code class="docutils literal notranslate"><span class="pre">unit</span> <span class="pre">=</span> <span class="pre">5</span></code>: After obtaining the final results, we smooth the data and calculate an axis with even intervals. Typically, we smooth over <code class="docutils literal notranslate"><span class="pre">num_avg</span></code> consecutive cells. You can also specify unit size on the x-axis. If not specified, we will use a default unit value equivalent to a 5 μm x-axis in the real world.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resolution</span></code>: Input resolution of sequencing tech, for VisuimHD is 2 um.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spatial_name</span></code>: A list of two strings specifying the names of the columns in <code class="docutils literal notranslate"><span class="pre">adata.obs</span></code> that contain the spatial coordinates. Defaults to <code class="docutils literal notranslate"><span class="pre">['array_row',</span> <span class="pre">'array_col']</span></code> from SMURF soft segmentation.</p></li>
</ol>
<p>The output of this function is a units_number * 2 numpy array representing the x-axis.</p>
<p><code class="docutils literal notranslate"><span class="pre">x_axis_pre(selected,</span> <span class="pre">seed=42,</span> <span class="pre">n_neighbors=50,</span> <span class="pre">spatial_name=['array_row',</span> <span class="pre">'array_col'])</span></code></p>
<p>This function is the same as <code class="docutils literal notranslate"><span class="pre">x_axis()</span></code>, but it only completes the first step. You should use this function first to confirm the values for <code class="docutils literal notranslate"><span class="pre">seed</span></code> and <code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code>, then use <code class="docutils literal notranslate"><span class="pre">x_axis()</span></code> to obtain the final results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">su</span><span class="o">.</span><span class="n">x_axis_pre</span><span class="p">(</span><span class="n">selected_mousebrain</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_14_0.png" src="../../_images/tutorials_notebooks_unroll_example_14_0.png" />
</div>
</div>
<p>Make sure the unwrapping looks good here. Then, we will create the x-axis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_axis_results_mousebrain</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">x_axis</span><span class="p">(</span><span class="n">selected_mousebrain</span><span class="p">,</span> <span class="n">adata_sc_final_mousebrain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_16_0.png" src="../../_images/tutorials_notebooks_unroll_example_16_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
One unit length on the x-axis is 5.00 μm. The total x-axis length is 0.9959 cm.
</pre></div></div>
</div>
</section>
<section id="su.select_rest_cells()">
<h2>su.select_rest_cells()<a class="headerlink" href="#su.select_rest_cells()" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">su.select_rest_cells(adata,</span> <span class="pre">selected=None,</span> <span class="pre">delete_xaxis=None,</span> <span class="pre">spatial_name=['array_row',</span> <span class="pre">'array_col'],</span> <span class="pre">so=None,)</span></code></p>
<p>The function will give you all the rest cells except for selected and delete_xaxis.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">adata</span></code>: Input your adata object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">selected</span></code>: In put your selected data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete_xaxis</span></code>: Input your data that is part of the x-axis but not included in the x-axis results (see the small intestine example).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cluster</span></code>: Provide a list of clusters to be included.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spatial_name</span></code>: A list of two strings specifying the names of the columns in <code class="docutils literal notranslate"><span class="pre">adata.obs</span></code> that contain the spatial coordinates. Defaults to <code class="docutils literal notranslate"><span class="pre">['array_row',</span> <span class="pre">'array_col']</span></code> from SMURF soft segmentation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">so</span></code>: If <code class="docutils literal notranslate"><span class="pre">spatial_name</span></code> are not in adata.obs, please input your <code class="docutils literal notranslate"><span class="pre">so</span></code> (spatial object) from the previous analysis.</p></li>
</ol>
<p>The output of this function includes all the cells that are not in <code class="docutils literal notranslate"><span class="pre">selected</span></code>or <code class="docutils literal notranslate"><span class="pre">delete_xaxis</span></code>, in the same format as <code class="docutils literal notranslate"><span class="pre">selected</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cells_mousebrain</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">select_rest_cells</span><span class="p">(</span><span class="n">adata_sc_final_mousebrain</span><span class="p">,</span> <span class="n">selected_mousebrain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">su</span><span class="o">.</span><span class="n">plot_selected</span><span class="p">(</span><span class="n">cells_mousebrain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_19_0.png" src="../../_images/tutorials_notebooks_unroll_example_19_0.png" />
</div>
</div>
</section>
<section id="su.y_axis()">
<h2>su.y_axis()<a class="headerlink" href="#su.y_axis()" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">su.y_axis(x_axis,</span> <span class="pre">cells,</span> <span class="pre">selected=None,</span> <span class="pre">delete_xaxis=[[np.zeros((0,</span> <span class="pre">1))],np.zeros((0,</span> <span class="pre">2))],</span> <span class="pre">unit=5,</span> <span class="pre">resolution=2,</span> <span class="pre">center</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">spatial_name</span> <span class="pre">=</span> <span class="pre">['array_row',</span> <span class="pre">'array_col'])</span></code></p>
<p>We use this function to unroll the y-axis using the straight-line distance.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x_axis</span></code>: Input your x_axis_results.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cells</span></code>: Input your cells for y-axis unrolling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">selected</span></code>: Input your selected cells for the x-axis. For all cells here, the y value will automatically be set to 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete_xaxis</span></code>: Input your data that is part of the x-axis but not included in the x-axis results (see the small intestine example).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unit</span></code>: Input a unit value representing how many µm it corresponds to on the x-axis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resolution</span></code>: Input resolution of sequencing tech, for VisuimHD is 2 um.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">center</span></code>: The center for reference, if not <code class="docutils literal notranslate"><span class="pre">None</span></code>, it requires the direction from each cell to the x-axis must match the direction from the cell to the center. Please input a 1*2 numpy array, eg: <code class="docutils literal notranslate"><span class="pre">center</span> <span class="pre">=</span> <span class="pre">np.array([1750,1600])</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spatial_name</span></code>: A list of two strings specifying the names of the columns in <code class="docutils literal notranslate"><span class="pre">adata.obs</span></code> that contain the spatial coordinates. Defaults to <code class="docutils literal notranslate"><span class="pre">['array_row',</span> <span class="pre">'array_col']</span></code> from SMURF soft segmentation.</p></li>
</ol>
<p>The output of this function is a pandas array of the cells and their information. You can directly concatenate it to <code class="docutils literal notranslate"><span class="pre">adata.obs</span></code> if desired.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_result_mousebrain</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">y_axis</span><span class="p">(</span><span class="n">x_axis_results_mousebrain</span><span class="p">,</span> <span class="n">cells_mousebrain</span><span class="p">,</span> <span class="n">selected_mousebrain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_21_0.png" src="../../_images/tutorials_notebooks_unroll_example_21_0.png" />
</div>
</div>
<p>Finally, filter for the part you want and take a look!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_result_mousebrain</span> <span class="o">=</span> <span class="n">final_result_mousebrain</span><span class="p">[(</span><span class="n">final_result_mousebrain</span><span class="p">[</span><span class="s1">&#39;x_flattened&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
                                                  <span class="p">(</span><span class="n">final_result_mousebrain</span><span class="p">[</span><span class="s1">&#39;x_flattened&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">final_result_mousebrain</span><span class="p">[</span><span class="s1">&#39;x_flattened&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">&amp;</span>
                                                  <span class="p">(</span><span class="n">final_result_mousebrain</span><span class="p">[</span><span class="s1">&#39;y_flattened&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">)]</span>

<span class="n">su</span><span class="o">.</span><span class="n">plot_final_result</span><span class="p">(</span><span class="n">final_result_mousebrain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_23_0.png" src="../../_images/tutorials_notebooks_unroll_example_23_0.png" />
</div>
</div>
<p>As mentioned earlier, some datasets require using a relative distance for the y-axis, where each cell must be connected to another cell, resulting in a one-by-one distance to the x-axis. Although the mouse brain data definitely requires this, we can still use it as a demonstration.</p>
</section>
<section id="su.y_axis_circle()">
<h2>su.y_axis_circle()<a class="headerlink" href="#su.y_axis_circle()" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">y_axis_circle(x_axis,</span> <span class="pre">cells,</span> <span class="pre">delete_xaxis=[[np.zeros((0,</span> <span class="pre">1))],</span> <span class="pre">np.zeros((0,</span> <span class="pre">2))],</span> <span class="pre">selected=None,</span> <span class="pre">n_neighbors_first=18,</span> <span class="pre">n_neighbors_rest=7,</span> <span class="pre">distance_cutoff=23,</span> <span class="pre">center=None,</span> <span class="pre">outside=True,</span> <span class="pre">max_iter=1000),</span> <span class="pre">unit=5,</span> <span class="pre">resolution=2,</span> <span class="pre">spatial_name</span> <span class="pre">=</span> <span class="pre">['array_row',</span> <span class="pre">'array_col'])</span></code></p>
<p>Here, we use a relative distance, where each cell must be connected to another cell, resulting in a one-by-one distance to the x-axis.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x_axis</span></code>: Input your x_axis_results.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cells</span></code>: Input your cells for y-axis unrolling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete_xaxis</span></code>: Input your delete_xaxis if you have any. (see mouse small intestine example for details.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">selected</span></code>: Input the cells selected for the x-axis. For these cells, the layer value will automatically be set to 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_neighbors_first</span></code>: The number of neighbors used when starting to connect cells to the x-axis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_neighbors_rest</span></code>: The number of neighbors for the remaining cells when connecting them.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distance_cutoff</span></code>: The distance cutoff for considering cells as connected to the x-axis and between cells.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">center</span></code> and <code class="docutils literal notranslate"><span class="pre">outside</span></code>: Since many circular datasets have a center, we can only extend in one direction. If there is no such center, you don’t need to input this parameter. Therefore, we provide an option for specifying the center. If y needs to extend outward, set <code class="docutils literal notranslate"><span class="pre">outside</span></code> = <code class="docutils literal notranslate"><span class="pre">True</span></code>; if it needs to extend inward, set it to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_iter</span></code>: The maximum number of iterations for the process.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unit</span></code>: Input a unit value representing how many µm it corresponds to on the x-axis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resolution</span></code>: Input resolution of sequencing tech, for VisuimHD is 2 um.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spatial_name</span></code>: A list of two strings specifying the names of the columns in <code class="docutils literal notranslate"><span class="pre">adata.obs</span></code> that contain the spatial coordinates. Defaults to <code class="docutils literal notranslate"><span class="pre">['array_row',</span> <span class="pre">'array_col']</span></code> from SMURF soft segmentation.</p></li>
</ol>
<p>The output of this function is a pandas array of the cells and their information. You can directly concatenate it to adata.obs if desired.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_result_mousebrain_circle</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">y_axis_circle</span><span class="p">(</span><span class="n">x_axis_results_mousebrain</span><span class="p">,</span> <span class="n">cells_mousebrain</span><span class="p">,</span> <span class="n">selected</span> <span class="o">=</span> <span class="n">selected_mousebrain</span><span class="p">,</span>
                                                  <span class="n">n_neighbors_first</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">n_neighbors_rest</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">distance_cutoff</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">center</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                                  <span class="n">outside</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
80it [00:44,  1.80it/s, Layer=79]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_25_1.png" src="../../_images/tutorials_notebooks_unroll_example_25_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_result_mousebrain_circle</span> <span class="o">=</span> <span class="n">final_result_mousebrain_circle</span><span class="p">[(</span><span class="n">final_result_mousebrain_circle</span><span class="p">[</span><span class="s1">&#39;x_flattened&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
                                 <span class="p">(</span><span class="n">final_result_mousebrain_circle</span><span class="p">[</span><span class="s1">&#39;x_flattened&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">final_result_mousebrain_circle</span><span class="p">[</span><span class="s1">&#39;x_flattened&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">&amp;</span>
                                 <span class="p">(</span><span class="n">final_result_mousebrain_circle</span><span class="p">[</span><span class="s1">&#39;y_flattened&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">)]</span>

<span class="n">su</span><span class="o">.</span><span class="n">plot_final_result</span><span class="p">(</span><span class="n">final_result_mousebrain_circle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_26_0.png" src="../../_images/tutorials_notebooks_unroll_example_26_0.png" />
</div>
</div>
</section>
<section id="Another-version">
<h2>Another version<a class="headerlink" href="#Another-version" title="Link to this heading">¶</a></h2>
<p>In the previous example, we used MouseBrain’s outliner to perform unrolling. Additionally, we could explore using Cortex’s bottom functionality. Below are some example code snippets:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">select_cells</span><span class="p">(</span><span class="n">adata_sc_final_mousebrain</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">cluster_name</span> <span class="o">=</span> <span class="s1">&#39;cell_cluster&#39;</span><span class="p">)</span>
<span class="n">su</span><span class="o">.</span><span class="n">plot_selected</span><span class="p">(</span><span class="n">selected_mousebrain2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_28_0.png" src="../../_images/tutorials_notebooks_unroll_example_28_0.png" />
</div>
</div>
</section>
<section id="su.select_boundary()">
<h2>su.select_boundary()<a class="headerlink" href="#su.select_boundary()" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">su.select_boundary(selected,</span> <span class="pre">alpha</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">auto_alpha_quantile</span> <span class="pre">=</span> <span class="pre">80,</span> <span class="pre">dedup_tol</span> <span class="pre">=</span> <span class="pre">1e-7,</span> <span class="pre">ratio</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">show_plot</span> <span class="pre">=</span> <span class="pre">True)</span></code></p>
<p>We use this function to grab the boundary of selected cells.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">selected</span></code>: Please input your selected data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code>: Concave-hull (alpha-shape) tightness. Larger means tighter boundary. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, auto-estimated from Delaunay triangle circumradii.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">auto_alpha_quantile</span></code>: Quantile used when <code class="docutils literal notranslate"><span class="pre">alpha=None</span></code>. Raise this value (e.g., 85–90) for a tighter, more detailed boundary; lower for smoother.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dedup_tol</span></code>: Input your data that is part of the x-axis but not included in the x-axis results (see the small intestine example).</p></li>
</ol>
<p>The output of this function is the cells of the boundary of selected cells.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">select_boundary</span><span class="p">(</span><span class="n">selected_mousebrain2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_30_0.png" src="../../_images/tutorials_notebooks_unroll_example_30_0.png" />
</div>
</div>
<p>Next, we pinpoint the specific layer we intend to unroll. I perform <code class="docutils literal notranslate"><span class="pre">su.clean_select</span></code> multiple times to prepare the best data for x-axis analysis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_mousebrain2</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="n">down</span><span class="o">=</span><span class="mi">2300</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">2600</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
                                       <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_32_0.png" src="../../_images/tutorials_notebooks_unroll_example_32_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain2</span> <span class="o">=</span>  <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_mousebrain2</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                        <span class="n">down</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">2600</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1100</span><span class="p">,</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
                                        <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_33_0.png" src="../../_images/tutorials_notebooks_unroll_example_33_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_mousebrain2</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="n">down</span><span class="o">=</span><span class="mi">1750</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">2600</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_34_0.png" src="../../_images/tutorials_notebooks_unroll_example_34_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_mousebrain2</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="n">down</span><span class="o">=</span><span class="mi">1350</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">2600</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_35_0.png" src="../../_images/tutorials_notebooks_unroll_example_35_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_mousebrain2</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="n">right</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
                                       <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_36_0.png" src="../../_images/tutorials_notebooks_unroll_example_36_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_mousebrain2</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="n">down</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">650</span><span class="p">,</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
                                       <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_37_0.png" src="../../_images/tutorials_notebooks_unroll_example_37_0.png" />
</div>
</div>
<p>Next, we begin constructing the x-axis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">su</span><span class="o">.</span><span class="n">x_axis_pre</span><span class="p">(</span><span class="n">selected_mousebrain2</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_39_0.png" src="../../_images/tutorials_notebooks_unroll_example_39_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_axis_results_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">x_axis</span><span class="p">(</span><span class="n">selected_mousebrain2</span><span class="p">,</span> <span class="n">adata_sc_final_mousebrain</span><span class="p">,</span> <span class="n">num_avg</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_40_0.png" src="../../_images/tutorials_notebooks_unroll_example_40_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
One unit length on the x-axis is 5.00 μm. The total x-axis length is 0.5542 cm.
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cells_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">select_rest_cells</span><span class="p">(</span><span class="n">adata_sc_final_mousebrain</span><span class="p">,</span> <span class="n">selected_mousebrain2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, we define the Y-axis and use the <code class="docutils literal notranslate"><span class="pre">center</span></code> as a pivot to control its orientation. The direction from each cell to the x-axis must match the direction from the cell to the <code class="docutils literal notranslate"><span class="pre">center</span></code>. Please select the appropriate <code class="docutils literal notranslate"><span class="pre">center</span></code> to meet this requirement.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_result_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">y_axis</span><span class="p">(</span><span class="n">x_axis_results_mousebrain2</span><span class="p">,</span> <span class="n">cells_mousebrain2</span><span class="p">,</span> <span class="n">selected_mousebrain2</span><span class="p">,</span>
                                    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3000</span><span class="p">,</span><span class="mi">200</span><span class="p">]),</span> <span class="n">delete_residues</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_43_0.png" src="../../_images/tutorials_notebooks_unroll_example_43_0.png" />
</div>
</div>
<p>To better understand the role of <code class="docutils literal notranslate"><span class="pre">center</span></code>, we remove it to observe the differences.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_result_mousebrain2</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">y_axis</span><span class="p">(</span><span class="n">x_axis_results_mousebrain2</span><span class="p">,</span> <span class="n">cells_mousebrain2</span><span class="p">,</span> <span class="n">selected_mousebrain2</span><span class="p">,</span> <span class="n">delete_residues</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_45_0.png" src="../../_images/tutorials_notebooks_unroll_example_45_0.png" />
</div>
</div>
</section>
</section>
<section id="Unrolling-Mouse-Small-Intestine-Data">
<h1>Unrolling Mouse Small Intestine Data<a class="headerlink" href="#Unrolling-Mouse-Small-Intestine-Data" title="Link to this heading">¶</a></h1>
<p>Let’s first start with the Mouse Small Intestine example.</p>
<p>Like previously, we will introduce the steps in this example:</p>
<ol class="arabic simple">
<li><p>Use <a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.select_cells()">su.select_cells()</a> to select the cells from the boundary cluster for the x-axis.</p></li>
<li><p>Use <a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.clean_select()">su.clean_select()</a> to clean the selected data.</p></li>
<li><p>Use <a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.x_axis()-and-su.x_axis_pre()">su.x_axis()</a> to build the x-axis.</p></li>
<li><p>Use <a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.select_rest_cells()">su.select_rest_cells()</a> to find all remaining cells for the y-axis.</p></li>
<li><p>Use <a class="reference external" href="https://the-mitra-lab.github.io/SMURF/tutorials/notebooks/unroll_example.html#su.y_axis_circle()">su.y_axis_circle()</a> to get the final results. Note that thiis step is different from previous example as we do not use direct distance for unrolling y axis.</p></li>
</ol>
<p>In the meantime, we can use <code class="docutils literal notranslate"><span class="pre">su.plot_selected()</span></code> to view our data and <code class="docutils literal notranslate"><span class="pre">su.plot_final_result()</span></code> to take a look at the final results.</p>
<p>To download the final result directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">The</span><span class="o">-</span><span class="n">Mitra</span><span class="o">-</span><span class="n">Lab</span><span class="o">/</span><span class="n">SMURF</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">datasets</span><span class="o">/</span><span class="n">adata_sc_final_smallintestine</span><span class="o">.</span><span class="n">h5ad</span><span class="o">.</span><span class="n">gz</span>
<span class="err">!</span> <span class="n">gunzip</span> <span class="n">adata_sc_final_smallintestine</span><span class="o">.</span><span class="n">h5ad</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#! wget https://github.com/The-Mitra-Lab/SMURF/releases/download/datasets/adata_sc_final_smallintestine.h5ad.gz</span>
<span class="c1">#! gunzip adata_sc_final_smallintestine.h5ad.gz</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adata_sc_final_smallintestine</span> <span class="o">=</span>  <span class="n">sc</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="s1">&#39;adata_sc_final_smallintestine.h5ad&#39;</span><span class="p">)</span>
<span class="n">adata_sc_final_smallintestine</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AnnData object with n_obs × n_vars = 403266 × 19059
    obs: &#39;cell_cluster&#39;, &#39;cos_simularity&#39;, &#39;cell_size&#39;, &#39;array_row&#39;, &#39;array_col&#39;, &#39;n_counts&#39;
    var: &#39;gene_ids&#39;, &#39;feature_types&#39;
    uns: &#39;spatial&#39;
    obsm: &#39;spatial&#39;
</pre></div></div>
</div>
<p>Here, we select clusters 24 and 26 for unrolling the x-axis. Actually, they represent muscle cells and neural cells.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">select_cells</span><span class="p">(</span><span class="n">adata_sc_final_smallintestine</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span> <span class="n">cluster_name</span> <span class="o">=</span> <span class="s1">&#39;cell_cluster&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">su</span><span class="o">.</span><span class="n">plot_selected</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_51_0.png" src="../../_images/tutorials_notebooks_unroll_example_51_0.png" />
</div>
</div>
<p>For these analysis please do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span> <span class="n">save_area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span>
                <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>first. Then do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                          <span class="n">save_area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
                                          <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>You can always perform this multiple times to prepare the best data for x-axis analysis. (like this example)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                          <span class="n">save_area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_54_0.png" src="../../_images/tutorials_notebooks_unroll_example_54_0.png" />
</div>
</div>
<p>It is normal to perform this process several times.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                          <span class="n">save_area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_56_0.png" src="../../_images/tutorials_notebooks_unroll_example_56_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                          <span class="n">save_area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_57_0.png" src="../../_images/tutorials_notebooks_unroll_example_57_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                          <span class="n">save_area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_58_0.png" src="../../_images/tutorials_notebooks_unroll_example_58_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                          <span class="n">save_area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span> <span class="n">return_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_59_0.png" src="../../_images/tutorials_notebooks_unroll_example_59_0.png" />
</div>
</div>
<p>Now, we make sure that all the selected cells should be part of the x-axis, and we would like to perform an x-axis preview analysis. We found that, regardless of the parameters used, we do not get good results at the beginning and end regions. The reason is due to tissue overlap and damage in these areas. At this point, we need to manually remove these regions. Note that, since these deleted parts still belong to the x-axis but are outside of our analyzable range, we still need to save them and
not include them in the subsequent y-axis analysis. Please refer to the following example section for specific usage.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">su</span><span class="o">.</span><span class="n">x_axis_pre</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_61_0.png" src="../../_images/tutorials_notebooks_unroll_example_61_0.png" />
</div>
</div>
<p>Start preserving the deleted data. Remember, <strong>do not assign values</strong> to the data until you have confirmed the function parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1680</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1300</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1500</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">2050</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_63_0.png" src="../../_images/tutorials_notebooks_unroll_example_63_0.png" />
</div>
</div>
<p><strong>After you have the first ``to_delete``, remember to input ``to_delete`` in the function input. Do this function as many time as you need.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1730</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1300</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1500</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_65_0.png" src="../../_images/tutorials_notebooks_unroll_example_65_0.png" />
</div>
</div>
<p>Please clean your data as many times as you want.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1780</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1300</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1600</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">1950</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_67_0.png" src="../../_images/tutorials_notebooks_unroll_example_67_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1750</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1300</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1600</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">1970</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_68_0.png" src="../../_images/tutorials_notebooks_unroll_example_68_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1630</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1340</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1610</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">2070</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_69_0.png" src="../../_images/tutorials_notebooks_unroll_example_69_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1620</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1340</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1610</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">2080</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_70_0.png" src="../../_images/tutorials_notebooks_unroll_example_70_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1720</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1340</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1610</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_71_0.png" src="../../_images/tutorials_notebooks_unroll_example_71_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1710</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1340</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1610</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">2020</span><span class="p">,</span>
                                                    <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_72_0.png" src="../../_images/tutorials_notebooks_unroll_example_72_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1650</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1340</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1610</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">2060</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_73_0.png" src="../../_images/tutorials_notebooks_unroll_example_73_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1780</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1160</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1510</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">1890</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_74_0.png" src="../../_images/tutorials_notebooks_unroll_example_74_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1580</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1360</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1410</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">1890</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_75_0.png" src="../../_images/tutorials_notebooks_unroll_example_75_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1580</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1110</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1500</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">1750</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_76_0.png" src="../../_images/tutorials_notebooks_unroll_example_76_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="mi">1580</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">1200</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">1440</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">1490</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                     <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_77_0.png" src="../../_images/tutorials_notebooks_unroll_example_77_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">2950</span><span class="p">,</span><span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                     <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                     <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_78_0.png" src="../../_images/tutorials_notebooks_unroll_example_78_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">2720</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">2660</span><span class="p">,</span> <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                     <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_79_0.png" src="../../_images/tutorials_notebooks_unroll_example_79_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">2820</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">2500</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                     <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_80_0.png" src="../../_images/tutorials_notebooks_unroll_example_80_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">2480</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">2800</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                     <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_81_0.png" src="../../_images/tutorials_notebooks_unroll_example_81_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">clean_select</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">down</span> <span class="o">=</span> <span class="mi">2300</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">2900</span><span class="p">,</span>
                                                     <span class="n">outlier_cutoff</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">outlier_neighbors</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_deleted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                     <span class="n">delete_xaxis</span><span class="o">=</span><span class="n">to_delete</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">avg_iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_82_0.png" src="../../_images/tutorials_notebooks_unroll_example_82_0.png" />
</div>
</div>
<p>Try <code class="docutils literal notranslate"><span class="pre">su.x_axis_pre</span></code>; it’s now perfect!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">su</span><span class="o">.</span><span class="n">x_axis_pre</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_84_0.png" src="../../_images/tutorials_notebooks_unroll_example_84_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_axis_results_smallintestine</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">x_axis</span><span class="p">(</span><span class="n">selected_smallintestine</span><span class="p">,</span>
                                          <span class="n">adata</span><span class="o">=</span><span class="n">adata_sc_final_smallintestine</span><span class="p">,</span>
                                          <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_85_0.png" src="../../_images/tutorials_notebooks_unroll_example_85_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
One unit length on the x-axis is 5.00 μm. The total x-axis length is 9.0145 cm.
</pre></div></div>
</div>
<p>Get the rest of the cells for y-axis analysis with <code class="docutils literal notranslate"><span class="pre">`su.select_rest_cells()</span></code> &lt;#select_rest_cells&gt;`__</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cells_smallintestine</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">select_rest_cells</span><span class="p">(</span><span class="n">adata_sc_final_smallintestine</span><span class="p">,</span> <span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<p>Get final data data by <code class="docutils literal notranslate"><span class="pre">`su.y_axis_circle()</span></code> &lt;#y_axis_circle&gt;`__</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">center</span></code> and <code class="docutils literal notranslate"><span class="pre">outside</span></code>: Since many circular datasets have a center, we can only extend in one direction. If there is no such center, you don’t need to input this parameter. Therefore, we provide an option for specifying the center. If y needs to extend outward, set <code class="docutils literal notranslate"><span class="pre">outside</span></code> = <code class="docutils literal notranslate"><span class="pre">True</span></code>; if it needs to extend inward, set it to <code class="docutils literal notranslate"><span class="pre">False</span></code>. If you’re interested, you can see what the result looks like without inputting this parameter here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_result_smallintestine</span> <span class="o">=</span> <span class="n">su</span><span class="o">.</span><span class="n">y_axis_circle</span><span class="p">(</span><span class="n">x_axis_results_smallintestine</span><span class="p">,</span> <span class="n">cells_smallintestine</span><span class="p">,</span> <span class="n">to_delete</span><span class="p">,</span>
                                               <span class="n">selected_smallintestine</span><span class="p">,</span> <span class="n">n_neighbors_first</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">n_neighbors_rest</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
                                               <span class="n">distance_cutoff</span> <span class="o">=</span> <span class="mi">23</span><span class="p">,</span> <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1750</span><span class="p">,</span><span class="mi">1600</span><span class="p">]),</span> <span class="n">outside</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
133it [35:50, 16.17s/it, Layer=132]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_unroll_example_89_1.png" src="../../_images/tutorials_notebooks_unroll_example_89_1.png" />
</div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="Tutorial_cell_segmentation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Nuclei Segmentation by StarDist</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Tutorial_Mousebrian_full.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Soft Segmentation Tutorial (Full version)</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Mitra Lab, Washington University in St. Louis
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Unrolling Tutorial</a><ul>
<li><a class="reference internal" href="#Dataset-Information">Dataset Information</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Unrolling-Mouse-Brain-Data">Unrolling Mouse Brain Data</a><ul>
<li><a class="reference internal" href="#su.select_cells()">su.select_cells()</a></li>
<li><a class="reference internal" href="#su.clean_select()">su.clean_select()</a></li>
<li><a class="reference internal" href="#su.x_axis()-and-su.x_axis_pre()">su.x_axis() and su.x_axis_pre()</a></li>
<li><a class="reference internal" href="#su.select_rest_cells()">su.select_rest_cells()</a></li>
<li><a class="reference internal" href="#su.y_axis()">su.y_axis()</a></li>
<li><a class="reference internal" href="#su.y_axis_circle()">su.y_axis_circle()</a></li>
<li><a class="reference internal" href="#Another-version">Another version</a></li>
<li><a class="reference internal" href="#su.select_boundary()">su.select_boundary()</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Unrolling-Mouse-Small-Intestine-Data">Unrolling Mouse Small Intestine Data</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=f5cff4aa"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/js/hoverxref.js"></script>
    <script src="../../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../../_static/js/micromodal.min.js"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>